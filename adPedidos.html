<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Administrar Pedidos</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-image: url('img/foto111.jpeg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: white;
    }
    .navbar-custom {
      background-color: rgba(0, 0, 0, 0.8);
    }
    .navbar-nav .nav-link {
      color: white !important;
    }
    .status {
      padding: 5px 10px;
      border-radius: 5px;
    }
    .status.entregado {
      background-color: green;
    }
    .status.en_camino {
      background-color: orange;
    }
    .status.cancelado {
      background-color: red;
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark navbar-custom">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Panel de Administración</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="ad.Usuario.html">Usuario</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="adPedidos.html">Pedidos</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="adVentas.html">Ventas</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="menu.html">Página principal</a>
        </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-5">
    <h1 class="mb-4">Administrar Pedidos</h1>
    <div class="card bg-dark text-white">
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-striped table-dark">
            <thead>
              <tr>
                <th scope="col"># Pedido</th>
                <th scope="col">Usuario</th>
                <th scope="col">Productos</th>
                <th scope="col">Dirección</th>
                <th scope="col">Estado</th>
                <th scope="col">Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr data-id="1">
                <td>1</td>
                <td>Usuario 1</td>
                <td>Cepillos</td>
                <td>Concepcion, Paicavi 3280</td>
                <td><span class="status entregado">Entregado</span></td>
                <td>
                  <button class="btn btn-sm btn-primary edit-btn" data-bs-toggle="modal" data-bs-target="#editModal"
                    data-id="1">Editar</button>
                  <button class="btn btn-sm btn-danger delete-btn" data-id="1">Eliminar</button>
                </td>
              </tr>
              <tr data-id="2">
                <td>2</td>
                <td>Usuario 2</td>
                <td>Juguetes</td>
                <td>456 Calle Alamo, Antofagasta</td>
                <td><span class="status cancelado">Cancelado</span></td>
                <td>
                  <button class="btn btn-sm btn-primary edit-btn" data-bs-toggle="modal" data-bs-target="#editModal"
                    data-id="2">Editar</button>
                  <button class="btn btn-sm btn-danger delete-btn" data-id="2">Eliminar</button>
                </td>
              </tr>
              <tr data-id="3">
                <td>3</td>
                <td>Usuario 3</td>
                <td>Rascador</td>
                <td>26 Calle Brasil, Linares</td>
                <td><span class="status en_camino">En Camino</span></td>
                <td>
                  <button class="btn btn-sm btn-primary edit-btn" data-bs-toggle="modal" data-bs-target="#editModal"
                    data-id="3">Editar</button>
                  <button class="btn btn-sm btn-danger delete-btn" data-id="3">Eliminar</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Modal -->
  <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editModalLabel">Editar Pedido</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="editForm">
            <input type="hidden" id="orderId">
            <div class="mb-3">
              <label for="username" class="form-label">Usuario</label>
              <input type="text" class="form-control" id="username">
            </div>
            <div class="mb-3">
              <label for="products" class="form-label">Productos</label>
              <input type="text" class="form-control" id="products">
            </div>
            <div class="mb-3">
              <label for="address" class="form-label">Dirección</label>
              <input type="text" class="form-control" id="address">
            </div>
            <div class="mb-3">
              <label for="status" class="form-label">Estado</label>
              <select class="form-select" id="status">
                <option value="entregado">Entregado</option>
                <option value="en_camino">En Camino</option>
                <option value="cancelado">Cancelado</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary save-btn">Guardar Cambios</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Modal -->
  <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteModalLabel">Confirmar Eliminación</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          ¿Estás seguro de que deseas eliminar este pedido?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-danger confirm-delete-btn">Eliminar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

  <script>
    $(document).ready(function () {
      let currentOrderId;

      $('.edit-btn').click(function () {
        currentOrderId = $(this).data('id');
        let $row = $('tr[data-id="' + currentOrderId + '"]');
        let username = $row.find('td:nth-child(2)').text();
        let products = $row.find('td:nth-child(3)').text();
        let address = $row.find('td:nth-child(4)').text();
        let status = $row.find('.status').text();

        $('#orderId').val(currentOrderId);
        $('#username').val(username);
        $('#products').val(products);
        $('#address').val(address);
        $('#status').val(status);

        $('#editModal').modal('show');
      });

      $('.save-btn').click(function () {
        let orderId = $('#orderId').val();
        let username = $('#username').val();
        let products = $('#products').val();
        let address = $('#address').val();
        let status = $('#status').val();

        if (username.trim() === '' || products.trim() === '' || address.trim() === '' || status.trim() === '') {
          alert('Por favor completa todos los campos.');
          return;
        }

        let $row = $('tr[data-id="' + orderId + '"]');
        $row.find('td:nth-child(2)').text(username);
        $row.find('td:nth-child(3)').text(products);
        $row.find('td:nth-child(4)').text(address);
        $row.find('.status').text(status).removeClass().addClass('status').addClass(status);

        $('#editModal').modal('hide');
      });

      $('.delete-btn').click(function () {
        currentOrderId = $(this).closest('tr').data('id');
        $('#deleteModal').modal('show');
      });

      $('.confirm-delete-btn').click(function () {
        let orderId = currentOrderId;

        $('tr[data-id="' + orderId + '"]').remove();

        $('#deleteModal').modal('hide');
      });
    });
  </script>
</body>

</html>
